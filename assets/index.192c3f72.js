var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,i=(t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,l=(e,t)=>{for(var n in t||(t={}))o.call(t,n)&&i(e,n,t[n]);if(r)for(var n of r(t))a.call(t,n)&&i(e,n,t[n]);return e},s=(e,r)=>t(e,n(r));import{r as c,u,R as m,a as h,V as f,D as p,b as d,Q as g,C as E,O as v,M as k,B as b,L as x,c as y,d as w,e as M,H as P,f as R,g as C,h as A,i as B}from"./vendor.07442813.js";var S=function(e,t,n){return Math.min(Math.max(t,e),n)},I=function(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e},L=function(e){return e[0]+e[1]+e[2]},j=function(e){return Math.pow(function(e){return L((n=e,[(t=e)[0]*n[0],t[1]*n[1],t[2]*n[2]]));var t,n}(e),.5)},N=function(e,t){var n,r,o=(r=t,[(n=e)[0]-r[0],n[1]-r[1],n[2]-r[2]]);return j(o)},q=function(e){if(3!==e.length)throw new Error("Cannot create V3 from "+e+", length is "+e.length+". Length should be 3");return e},G=function(e){return[e.x,e.y,e.z]},W=function(e,t){var n=F(t),r=O(t,I(I([],e),[0])),o=O(r,n);return[o[0],o[1],o[2]]},O=function(e,t){var n=e[0],r=e[1],o=e[2],a=e[3],i=t[0],l=t[1],s=t[2],c=t[3];return[n*c+a*i+r*s-o*l,r*c+a*l+o*i-n*s,o*c+a*s+n*l-r*i,a*c-n*i-r*l-o*s]},D=function(e){var t=e[0],n=e[1],r=e[2],o=Math.cos,a=Math.sin,i=o(t/2),l=o(n/2),s=o(r/2),c=a(t/2),u=a(n/2),m=a(r/2);return[c*l*s+i*u*m,i*u*s-c*l*m,i*l*m+c*u*s,i*l*s-c*u*m]},F=function(e){return[-e[0],-e[1],-e[2],e[3]]},z=function(e){return Math.hypot.apply(Math,e)},H=function(e,t,n){var r=[e[0],e[1],e[2]],o=e[3],a=q(r.map((function(e,r){var a=2*Math.atan(e/o),i=t[r],l=n[r];if(i>l)throw new Error("Lower bound should be less than upper bound for component "+r+". Lower: "+i+", upper: "+l);var s=S(a,i,l);return Math.tan(.5*s)})));return function(e){var t=Math.hypot.apply(Math,e);return 0===t?[0,0,0,1]:[e[0]/t,e[1]/t,e[2]/t,e[3]/t]}([a[0],a[1],a[2],1])},T=function(e){return[e.x,e.y,e.z,e.w]},X=function(e,t,n){for(var r=new Array(2),o=0;o<2;o++){var a=e[o],i=t[o];r[o]=n(a,i)}return V(r)},Y=function(e){return Math.pow(function(e){return Math.pow(e[0],2)+Math.pow(e[1],2)}(e),.5)},Q=function(e,t){var n=X(e,t,(function(e,t){return e-t}));return Y(n)},V=function(e){if(2!==e.length)throw new Error("Cannot create V2 from "+e+", length is "+e.length+". Length should be 2");return e},J=function(e,t){return r=t,o=(n=[e,0])[0],a=n[1],i=Math.cos(r),l=Math.sin(r),[o*i-a*l,o*l+a*i];var n,r,o,a,i,l};function $(e,t,n,r){var o,a,i,l=null!==(o=null==r?void 0:r.deltaAngle)&&void 0!==o?o:1e-5,s=null!==(a=null==r?void 0:r.learningRate)&&void 0!==a?a:1e-4,c=null!==(i=null==r?void 0:r.acceptedError)&&void 0!==i?i:0,u=U(e,t),m=u.transforms,h=u.effectorPosition,f=Q(n,h);if(f<c)return{links:e.map(Z),isWithinAcceptedError:!0,getErrorDistance:function(){return f}};if(m.length!==e.length+1)throw new Error("Joint transforms should have the same length as links + 1. Got "+m.length+", expected "+e.length);var p=e.map((function(t,r){var o=t.rotation,a=void 0===o?0:o,i=t.length,c=t.constraints,u=K(function(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e}([{length:i,rotation:a+l}],e.slice(r+1)),m[r],n);return{rotation:a+-((u-f)/l)*("function"==typeof s?s(u):s),length:i,constraints:c}})),d=U(p,t).transforms,g=p.map((function(e,t){var n=e.length,r=e.rotation,o=e.constraints;if(void 0===o)return{length:n,rotation:r};if("number"==typeof o){var a=o/2;return{length:n,rotation:S(r,-a,a),constraints:o}}return function(e){return void 0!==e.value}(o)?"global"===o.type?{length:n,rotation:r+(o.value-d[t+1].rotation),constraints:o}:{length:n,rotation:o.value,constraints:o}:{length:n,rotation:S(r,o.min,o.max),constraints:o}}));return{links:g,getErrorDistance:function(){return K(g,t,n)},isWithinAcceptedError:void 0}}function K(e,t,n){var r=function(e,t){return U(e,t).effectorPosition}(e,t);return Q(n,r)}function U(e,t){for(var n,r,o,a=[t],i=0;i<e.length;i++){var l=e[i],s=a[i],c=(null!==(n=l.rotation)&&void 0!==n?n:0)+s.rotation,u=J(l.length,c),m=(r=u,o=s.position,X(r,o,(function(e,t){return e+t})));a.push({position:m,rotation:c})}return{transforms:a,effectorPosition:a[a.length-1].position,effectorRotation:a[a.length-1].rotation}}function Z(e){var t=e.rotation,n=e.length,r=e.constraints;return{rotation:t,length:n,constraints:void 0===r?void 0:r}}var _=function(){return(_=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},ee=function(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e};function te(e,t,n,r){var o,a,i,l=null!==(o=null==r?void 0:r.deltaAngle)&&void 0!==o?o:1e-5,s=null!==(a=null==r?void 0:r.learningRate)&&void 0!==a?a:1e-4,c=null!==(i=null==r?void 0:r.acceptedError)&&void 0!==i?i:0,u=re(e,t),m=u.transforms,h=u.effectorPosition,f=N(n,h);if(f<c)return{links:e.map(oe),isWithinAcceptedError:!0,getErrorDistance:function(){return f}};if(m.length!==e.length+1)throw new Error("Joint transforms should have the same length as links + 1. Got "+m.length+", expected "+e.length);var p=e.map((function(t,r){var o=t.length,a=t.rotation,i=void 0===a?[0,0,0,1]:a,c=t.constraints,u=q([0,0,0].map((function(t,a){var c=[0,0,0];c[a]=l;var u={length:o,rotation:O(i,D(q(c)))},h=ne(ee([u],e.slice(r+1)),m[r],n);return-((h-f)/l)*("function"==typeof s?s(h):s)}))),h=O(i,D(u));return{length:o,rotation:h,constraints:c}})),d=re(p,t).transforms,g=p.map((function(e,t){var n,r,o,a=e.length,i=e.rotation,l=e.constraints;if(void 0===l)return{length:a,rotation:i};if(ie(l)){if("global"===l.type){var s=l.value,c=d[t+1].rotation;return{length:a,rotation:O(O(i,(r=F(n=c),o=z(n),[r[0]/o,r[1]/o,r[2]/o,r[3]/o])),s),constraints:l}}return{length:a,rotation:l.value,constraints:l}}var u,m,h,f,p,g,E=l.pitch,v=l.yaw,k=l.roll;return"number"==typeof E?(u=-E/2,m=E/2):void 0===E?(u=-1/0,m=1/0):(u=E.min,m=E.max),"number"==typeof v?(h=-v/2,f=v/2):void 0===v?(h=-1/0,f=1/0):(h=v.min,f=v.max),"number"==typeof k?(p=-k/2,g=k/2):void 0===k?(p=-1/0,g=1/0):(p=k.min,g=k.max),{length:a,rotation:H(i,[u,h,p],[m,f,g]),constraints:ae(l)}}));return{links:g,getErrorDistance:function(){return ne(g,t,n)},isWithinAcceptedError:void 0}}function ne(e,t,n){var r=function(e,t){return re(e,t).effectorPosition}(e,t);return N(n,r)}function re(e,t){for(var n,r,o,a,i=[_({},t)],l=0;l<e.length;l++){var s=e[l],c=i[l],u=O(c.rotation,null!==(n=s.rotation)&&void 0!==n?n:[0,0,0,1]),m=(a=s.length,W([a,0,0],u)),h=(r=m,o=c.position,[r[0]+o[0],r[1]+o[1],r[2]+o[2]]);i.push({position:h,rotation:u})}return{transforms:i,effectorPosition:i[i.length-1].position}}function oe(e){var t=e.rotation,n=e.length,r=e.constraints;return{rotation:t,length:n,constraints:void 0===r?void 0:ae(r)}}function ae(e){var t={};if(ie(e))return{type:e.type,value:ee([],e.value)};var n=e.pitch,r=e.yaw,o=e.roll;return"number"==typeof n?t.pitch=n:void 0!==typeof n&&(t.pitch=_({},n)),"number"==typeof r?t.yaw=r:void 0!==typeof r&&(t.yaw=_({},r)),"number"==typeof o?t.roll=o:void 0!==typeof o&&(t.roll=_({},o)),t}function ie(e){return void 0!==e.value}const le=(e,t)=>{const n=c.exports.useRef(),r=c.exports.useRef(),o=c.exports.useCallback((async a=>{void 0===r.current&&(r.current=a);const i=a-r.current;i>1e3/e&&(await t(i),r.current=a),n.current=requestAnimationFrame(o)}),[t,e]);c.exports.useEffect((()=>(n.current=requestAnimationFrame(o),()=>{n.current&&cancelAnimationFrame(n.current)})),[o])},se=({links:e,base:t})=>{const n=c.exports.useRef();u((()=>{var r;if(void 0===n.current)return;const{transforms:o}=re(e,t);for(let e=0;e<n.current.children.length;e++){const t=n.current.children[e],a=null==(r=o[e])?void 0:r.position;if(void 0===a)throw new Error(`No corresponding child position for index ${e}`);t.position.set(...a)}}));const r=c.exports.useMemo((()=>Array.from({length:e.length+1}).map(((e,t)=>m.createElement("mesh",{key:t},m.createElement("boxBufferGeometry",{args:[.1,.1,.5]}),m.createElement("meshBasicMaterial",{color:"red"}))))),[e]);return m.createElement("group",{ref:n},r)},ce=({target:e,links:t,base:n})=>{const r=c.exports.useRef(null);return le(1,(()=>{r.current&&(r.current.innerText=ne(t,n,e).toFixed(3))})),m.createElement("div",{style:{position:"absolute",top:0,left:0,userSelect:"none"}},m.createElement("table",null,m.createElement("tbody",null,m.createElement("tr",null,m.createElement("td",null,"Distance"),m.createElement("td",{ref:r})))))},ue=({position:e,setPosition:t})=>{const{camera:n}=h();return c.exports.useEffect((()=>{const e=e=>{const r=new f,o=new f;r.set(e.clientX/window.innerWidth*2-1,-e.clientY/window.innerHeight*2+1,.5),r.unproject(n),r.sub(n.position).normalize();const a=-n.position.z/r.z;o.copy(n.position).add(r.multiplyScalar(a)),t(G(o))};return window.addEventListener("click",e),()=>{window.removeEventListener("click",e)}}),[]),m.createElement("mesh",{position:[...e]},m.createElement("boxBufferGeometry",{args:[.3,.3,.3]}),m.createElement("meshBasicMaterial",{color:"hotpink"}))};function me(){return m.createElement(m.Fragment,null,m.createElement("mesh",{scale:[100,100,1],position:[0,0,-100]},m.createElement("planeBufferGeometry",null),m.createElement("meshNormalMaterial",null)),m.createElement("mesh",{scale:[100,100,1],position:[0,-50,0],rotation:[Math.PI/2,0,0]},m.createElement("planeBufferGeometry",null),m.createElement("meshNormalMaterial",{side:p})))}function he(){const{nodes:e}=d("https://tmf-code.github.io/inverse-kinematics/assets/tube.b3f995e8.gltf"),{base:t,bones:n,links:r}=c.exports.useMemo((()=>{const t=e.Bone,n={position:G(t.getWorldPosition(new f)),rotation:T(t.getWorldQuaternion(new g))};let r=t;const o=[t];for(;void 0!==r.children[0];)o.push(r.children[0]),r=r.children[0];const a=o.map(((e,t,n)=>{var r;const o=null==(r=n[t+1])?void 0:r.getWorldPosition(new f);if(o){const t=N(G(o),G(e.getWorldPosition(new f)));return{rotation:T(e.quaternion),length:t}}return{rotation:T(e.quaternion),length:0}}));return console.log(a,o),{base:n,bones:o,links:a}}),[e]),[o,a]=c.exports.useState([500,50,0]),i=c.exports.useRef();return le(60,(()=>{const e=r.reduce(((e,t)=>e+t.length),0);const a=te(r,t,o,{learningRate:function(t){const n=S(t/e,0,1);return n>.1?.01:.001+.001*(n/.02)},acceptedError:e/1e3}).links;r.forEach(((e,t)=>{const o=a[t];r[t]=o;const i=o.rotation;n[t].quaternion.set(...i)}))})),m.createElement("div",null,m.createElement(E,{style:{width:"100%",height:"100%",position:"absolute",backgroundColor:"purple"},linear:!0},m.createElement(v,null),m.createElement(me,null),m.createElement(c.exports.Suspense,{fallback:null},m.createElement("group",{dispose:null,scale:[1,1,1]},m.createElement(ue,{position:o,setPosition:a}),m.createElement(se,{base:t,links:r}),m.createElement("group",{rotation:[Math.PI/2,Math.PI/2,0]},m.createElement("primitive",{object:e.Bone}),m.createElement("skinnedMesh",{ref:i,geometry:e.Cylinder.geometry,material:new k,skeleton:e.Cylinder.skeleton}))))),m.createElement(ce,{target:o,links:r,base:t}))}const fe=({link:e,child:t})=>{const n=c.exports.useRef(),r=c.exports.useRef();u((()=>{n.current&&r.current&&(n.current.quaternion.set(...e.rotation),r.current.position.set(e.length,0,0))}));const o=c.exports.useMemo((()=>{const t=[new f,new f(e.length,0,0)],n=(new b).setFromPoints(t),r=new x({color:new y("#8B008B")});return new w(n,r)}),[e.length]);return m.createElement("group",{ref:n},m.createElement("mesh",{ref:r},m.createElement("sphereBufferGeometry",{args:[.2,8,8]}),m.createElement("meshStandardMaterial",{transparent:!0,wireframe:!0}),t&&m.createElement(fe,l({},t))),m.createElement("primitive",{object:o}))},pe=({base:e,links:t})=>{const n=c.exports.useRef(),r=c.exports.useMemo((()=>function(e){var t;let n;for(let r=e.length-1;r>=0;r--){const o={link:s(l({},e[r]),{rotation:null!=(t=e[r].rotation)?t:[0,0,0,1]})};void 0!==n?n={link:o.link,child:n}:n=o}return n}(t)),[t]);return u((()=>{var o;if(!n.current)return;n.current.position.set(...e.position),n.current.quaternion.set(...e.rotation);let a=0,i=r;for(;void 0!==i&&void 0!==t[a];)i.link.rotation=null!=(o=t[a].rotation)?o:[0,0,0,1],a++,i=i.child})),m.createElement("mesh",{ref:n},m.createElement("boxBufferGeometry",{args:[.3,.3,.01]}),m.createElement("meshNormalMaterial",null),r&&m.createElement(fe,l({},r)))};const de={position:[0,0,0],rotation:[0,0,0,1]};function ge(){const[e,t]=c.exports.useState([500,50,0]),[n,r]=c.exports.useState([]),{linkCount:o,linkLength:a,linkMinAngle:i,linkMaxAngle:l}=M({linkCount:{value:4,min:0,max:50,step:1},linkLength:{value:1,min:.1,max:2,step:.1},linkMinAngle:{value:-90,min:-360,max:0,step:10},linkMaxAngle:{value:90,min:0,max:360,step:10}});return c.exports.useEffect((()=>{r(Ee(o,a,i,l))}),[o,a,i,l]),le(60,(()=>{const t=o*a;const r=te(n,de,e,{learningRate:function(e){const n=S(e/t,0,1);return n>.5?.01:(.001+.001*(n/.02))/t},acceptedError:.1}).links;n.forEach(((e,t)=>{n[t]=r[t]}))})),m.createElement("div",null,m.createElement(E,{style:{width:"100%",height:"100%",position:"absolute",backgroundColor:"aquamarine"},linear:!0},m.createElement(v,null),m.createElement("group",null,m.createElement(pe,{base:de,links:n}),m.createElement(se,{links:n,base:de}),m.createElement(ue,{position:e,setPosition:t}))),m.createElement(ce,{target:e,links:n,base:de}))}const Ee=(e,t,n,r)=>Array.from({length:e}).map((()=>({length:t,rotation:[0,0,0,1],constraints:{pitch:{min:n*Math.PI/180,max:r*Math.PI/180},yaw:{min:n*Math.PI/180,max:r*Math.PI/180},roll:{min:n*Math.PI/180,max:r*Math.PI/180}}})));function ve(){const[e,t]=c.exports.useState([500,50,0]),[n,r]=c.exports.useState([]),[o,a]=c.exports.useState({position:[0,0,0],rotation:[0,0,0,1]}),i=c.exports.useRef(void 0),l=c.exports.useRef();return c.exports.useEffect((()=>{if(void 0===l.current)return;if(void 0!==i.current)return;const e=[],t=n=>{e.push(n),n.children[0]&&t(n.children[0])};l.current.children[0]&&t(l.current.children[0]);const n=e.map((e=>({rotation:T(e.quaternion),length:j(G(e.position))})));r(n),a({position:G(l.current.getWorldPosition(new f)),rotation:T(l.current.getWorldQuaternion(new g))}),i.current=e})),le(60,(()=>{if(!i.current)return;const t=n.reduce(((e,t)=>e+t.length),0);const r=te(n,o,e,{learningRate:function(e){const n=S(e/t,0,1);return n>.1?.01:.001+.001*(n/.02)},acceptedError:t/1e3}).links;n.forEach(((e,t)=>{const o=r[t];n[t]=o;const a=o.rotation,l=i.current[t],s=null==l?void 0:l.position.length(),c=W([s,0,0],a);l.position.set(...c),l.quaternion.set(...a)}))})),m.createElement("div",null,m.createElement(E,{style:{width:"100%",height:"100%",position:"absolute",backgroundColor:"aquamarine"},linear:!0},m.createElement(v,null),m.createElement(pe,{base:o,links:n}),m.createElement(se,{links:n,base:o}),m.createElement(ue,{position:e,setPosition:t}),m.createElement("group",{position:[0,0,0],ref:l},m.createElement("mesh",{position:[2,0,0]},m.createElement("sphereBufferGeometry",{args:[.3]}),m.createElement("meshNormalMaterial",{wireframe:!0}),m.createElement("mesh",{position:[2,0,0]},m.createElement("sphereBufferGeometry",{args:[.3]}),m.createElement("meshNormalMaterial",{wireframe:!0}),m.createElement("mesh",{position:[2,0,0]},m.createElement("sphereBufferGeometry",{args:[.3]}),m.createElement("meshNormalMaterial",{wireframe:!0})))))),m.createElement(ce,{target:e,links:n,base:o}))}const ke=({link:e,child:t})=>{const n=c.exports.useRef(),r=c.exports.useRef();u((()=>{n.current&&r.current&&(n.current.rotation.set(0,0,e.rotation),r.current.position.set(e.length,0,0))}));const o=c.exports.useMemo((()=>{const t=[new f,new f(e.length,0,0)],n=(new b).setFromPoints(t),r=new x({color:new y("#8B008B")});return new w(n,r)}),[e.length]);return m.createElement("group",{ref:n},m.createElement("mesh",{ref:r},m.createElement("sphereBufferGeometry",{args:[20,100,100]}),m.createElement("meshNormalMaterial",null),t&&m.createElement(ke,l({},t))),m.createElement("primitive",{object:o}))},be=({base:e,links:t})=>{const n=c.exports.useRef(),r=c.exports.useMemo((()=>function(e){var t;let n;for(let r=e.length-1;r>=0;r--){const o={link:s(l({},e[r]),{rotation:null!=(t=e[r].rotation)?t:0})};void 0!==n?n={link:o.link,child:n}:n=o}return n}(t)),[t]);return u((()=>{var o;if(!n.current)return;n.current.position.set(...e.position,0),n.current.rotation.set(0,0,e.rotation);let a=0,i=r;for(;void 0!==i&&void 0!==t[a];)i.link.rotation=null!=(o=t[a].rotation)?o:0,a++,i=i.child})),m.createElement("mesh",{ref:n},m.createElement("boxBufferGeometry",{args:[50,50]}),m.createElement("meshNormalMaterial",null),r&&m.createElement(ke,l({},r)))};const xe=({links:e,base:t})=>{const n=c.exports.useRef();u((()=>{var r;if(void 0===n.current)return;const{transforms:o}=U(e,t);for(let e=0;e<n.current.children.length;e++){const t=n.current.children[e],a=null==(r=o[e])?void 0:r.position;if(void 0===a)throw new Error(`No corresponding child position for index ${e}`);t.position.set(...a,100)}}));const r=c.exports.useMemo((()=>Array.from({length:e.length+1}).map(((e,t)=>m.createElement("mesh",{key:t},m.createElement("boxBufferGeometry",{args:[12.5,12.5]}),m.createElement("meshBasicMaterial",{color:"red"}))))),[e]);return m.createElement("group",{ref:n},r)},ye=({target:e,links:t,base:n})=>{const r=c.exports.useRef(null);return le(1,(()=>{r.current&&(r.current.innerText=K(t,n,e).toFixed(3))})),m.createElement("div",{style:{position:"absolute",top:0,left:0,userSelect:"none"}},m.createElement("table",null,m.createElement("tbody",null,m.createElement("tr",null,m.createElement("td",null,"Distance"),m.createElement("td",{ref:r})))))},we=({position:e})=>m.createElement("mesh",{scale:[50,50,1],position:[...e,-1]},m.createElement("boxBufferGeometry",null),m.createElement("meshBasicMaterial",{color:"hotpink"})),Me={position:[0,0],rotation:0};function Pe(){const[e,t]=c.exports.useState([500,50]),[n,r]=c.exports.useState([]),{linkCount:o,linkLength:a,linkMinAngle:i,linkMaxAngle:l}=M({linkCount:{value:4,min:0,max:50,step:1},linkLength:{value:200,min:1,max:200,step:10},linkMinAngle:{value:-90,min:-360,max:0,step:10},linkMaxAngle:{value:90,min:0,max:360,step:10}});return c.exports.useEffect((()=>{r(Re(o,a,i,l))}),[o,a,i,l]),le(60,(()=>{const t=o*a;const r=$(n,Me,e,{learningRate:function(e){const n=S(e/t,0,1);return n>.1?1e-5:1e-6+1e-6*(n/.02)},acceptedError:10}).links;n.forEach(((e,t)=>{n[t]=r[t]}))})),m.createElement("div",{onClick:({clientX:e,clientY:n})=>t([e-window.innerWidth/2,-n+window.innerHeight/2])},m.createElement(E,{style:{width:"100%",height:"100%",position:"absolute",backgroundColor:"aquamarine"},orthographic:!0,linear:!0,camera:{near:-1e3}},m.createElement(xe,{links:n,base:Me}),m.createElement(be,{base:Me,links:n}),m.createElement(we,{position:e})),m.createElement(ye,{target:e,links:n,base:Me}))}const Re=(e,t,n,r)=>Array.from({length:e}).map((()=>({length:t,constraint:{min:n*Math.PI/180,max:r*Math.PI/180},rotation:0}))),Ce={position:[0,0],rotation:0};function Ae(){const[e,t]=c.exports.useState([500,50]),[n,r]=c.exports.useState([]),{linkCount:o,linkLength:a,endEffectorRotation:i}=M({linkCount:{value:4,min:0,max:50,step:1},linkLength:{value:200,min:1,max:200,step:10},endEffectorRotation:{value:0}});return c.exports.useEffect((()=>{r(Be(o,a,i))}),[o,a,i]),le(60,(()=>{const t=o*a;const r=$(n,Ce,e,{learningRate:function(e){const n=S(e/t,0,1);return n>.1?1e-5:1e-6+1e-6*(n/.02)},acceptedError:10}).links;n.forEach(((e,t)=>{n[t]=r[t]}))})),m.createElement("div",{onClick:({clientX:e,clientY:n})=>t([e-window.innerWidth/2,-n+window.innerHeight/2])},m.createElement(E,{style:{width:"100%",height:"100%",position:"absolute",backgroundColor:"aquamarine"},orthographic:!0,linear:!0,camera:{near:-1e3}},m.createElement(xe,{links:n,base:Ce}),m.createElement(be,{base:Ce,links:n}),m.createElement(we,{position:e})),m.createElement(ye,{target:e,links:n,base:Ce}))}const Be=(e,t,n)=>Array.from({length:e}).map(((r,o)=>o===e-1?{length:t,constraint:{value:n*Math.PI/180,type:"local"},rotation:0}:{length:t,rotation:0})),Se={position:[0,0,0],rotation:[0,0,0,1]};function Ie(){const[e,t]=c.exports.useState([500,50,0]),[n,r]=c.exports.useState([]),{linkCount:o,linkLength:a,endEffectorRotation:i}=M({linkCount:{value:4,min:0,max:50,step:1},linkLength:{value:1,min:.1,max:2,step:.1},endEffectorRotation:{value:0,min:-180,max:180,step:5}});return c.exports.useEffect((()=>{r(Le(o,a,i))}),[o,a,i]),le(60,(()=>{const t=o*a;const r=te(n,Se,e,{learningRate:function(e){const n=S(e/t,0,1);return n>.5?.01:(.001+.001*(n/.02))/t},acceptedError:.1}).links;n.forEach(((e,t)=>{n[t]=r[t]}))})),m.createElement("div",null,m.createElement(E,{style:{width:"100%",height:"100%",position:"absolute",backgroundColor:"aquamarine"},linear:!0},m.createElement(v,null),m.createElement(se,{links:n,base:Se}),m.createElement(pe,{base:Se,links:n}),m.createElement(ue,{position:e,setPosition:t})),m.createElement(ce,{target:e,links:n,base:Se}))}const Le=(e,t,n)=>Array.from({length:e}).map(((r,o)=>o===e-1?{length:t,constraints:{value:D([0,0,n*Math.PI/180]),type:"local"},rotation:[0,0,0,1]}:{length:t,rotation:[0,0,0,1]})),je={position:[0,0],rotation:0};function Ne(){const[e,t]=c.exports.useState([500,50]),[n,r]=c.exports.useState([]),{linkCount:o,linkLength:a,endEffectorRotation:i}=M({linkCount:{value:4,min:0,max:50,step:1},linkLength:{value:200,min:1,max:200,step:10},endEffectorRotation:{value:0,min:-180,max:180,step:15}});return c.exports.useEffect((()=>{r(qe(o,a,i))}),[o,a,i]),le(60,(()=>{const t=o*a;const r=$(n,je,e,{learningRate:function(e){const n=S(e/t,0,1);return n>.1?1e-5:1e-6+1e-6*(n/.02)},acceptedError:10}).links;n.forEach(((e,t)=>{n[t]=r[t]}))})),m.createElement("div",{onClick:({clientX:e,clientY:n})=>t([e-window.innerWidth/2,-n+window.innerHeight/2])},m.createElement(E,{style:{width:"100%",height:"100%",position:"absolute",backgroundColor:"aquamarine"},orthographic:!0,linear:!0,camera:{near:-1e3}},m.createElement(xe,{links:n,base:je}),m.createElement(be,{base:je,links:n}),m.createElement(we,{position:e})),m.createElement(ye,{target:e,links:n,base:je}))}const qe=(e,t,n)=>Array.from({length:e}).map(((r,o)=>{return o===e-1?{length:t,constraint:{value:n*Math.PI/180,type:"global"},rotation:0}:(void 0===a&&(a=0),{length:t,rotation:a,constraints:i});var a,i})),Ge={position:[0,0,0],rotation:[0,0,0,1]};function We(){const[e,t]=c.exports.useState([500,50,0]),[n,r]=c.exports.useState([]),{linkCount:o,linkLength:a,endEffectorRotation:i}=M({linkCount:{value:4,min:0,max:50,step:1},linkLength:{value:1,min:.1,max:2,step:.1},endEffectorRotation:{value:0,min:-180,max:180,step:5}});return c.exports.useEffect((()=>{r(Oe(o,a,i))}),[o,a,i]),le(60,(()=>{const t=o*a;const r=te(n,Ge,e,{learningRate:function(e){const n=S(e/t,0,1);return n>.5?.01:(.001+.001*(n/.02))/t},acceptedError:.1}).links;n.forEach(((e,t)=>{n[t]=r[t]}))})),m.createElement("div",null,m.createElement(E,{style:{width:"100%",height:"100%",position:"absolute",backgroundColor:"aquamarine"},linear:!0},m.createElement(v,null),m.createElement(se,{links:n,base:Ge}),m.createElement(pe,{base:Ge,links:n}),m.createElement(ue,{position:e,setPosition:t})),m.createElement(ce,{target:e,links:n,base:Ge}))}const Oe=(e,t,n)=>Array.from({length:e}).map(((r,o)=>o===e-1?{length:t,constraints:{value:D([0,0,n*Math.PI/180]),type:"global"},rotation:[0,0,0,1]}:{length:t,rotation:[0,0,0,1]}));function De(){return m.createElement(P,{basename:"/"},m.createElement(Fe,null),m.createElement(R,{path:"/2d"},m.createElement(Pe,null)),m.createElement(R,{path:"/2d-local"},m.createElement(Ae,null)),m.createElement(R,{path:"/2d-global"},m.createElement(Ne,null)),m.createElement(R,{exact:!0,path:"/"},m.createElement(Pe,null)),m.createElement(R,{path:"/3d"},m.createElement(ge,null)),m.createElement(R,{path:"/3d-local"},m.createElement(Ie,null)),m.createElement(R,{path:"/3d-global"},m.createElement(We,null)),m.createElement(R,{path:"/three-js"},m.createElement(ve,null)),m.createElement(R,{path:"/skinned-mesh"},m.createElement(c.exports.Suspense,{fallback:null},m.createElement(he,null))))}function Fe(){const e=C().pathname;return m.createElement("div",{style:{position:"absolute",zIndex:10}},m.createElement("h2",null,"Inverse kinematics examples"),m.createElement("a",{href:"https://github.com/tmf-code/inverse-kinematics"},"Github page"),m.createElement("h3",null,"2d"),m.createElement("ul",null,m.createElement("li",{className:"/2d"===e?"highlighted":""},m.createElement(A,{to:"/2d"},"2D basic")),m.createElement("li",{className:"/2d-local"===e?"highlighted":""},m.createElement(A,{to:"/2d-local"},"Constrained local rotation")),m.createElement("li",{className:"/2d-global"===e?"highlighted":""},m.createElement(A,{to:"/2d-global"},"Constrained global rotation"))),m.createElement("h3",null,"3d"),m.createElement("ul",null,m.createElement("li",{className:"/3d"===e?"highlighted":""},m.createElement(A,{to:"/3d"},"3D basic")),m.createElement("li",{className:"/three-js"===e?"highlighted":""},m.createElement(A,{to:"/three-js"},"Three.js")),m.createElement("li",null,m.createElement(A,{to:"/skinned-mesh"},"Three js Skinned Mesh")),m.createElement("li",{className:"/3d-local"===e?"highlighted":""},m.createElement(A,{to:"/3d-local"},"Constrained local rotation")),m.createElement("li",{className:"/3d-global"===e?"highlighted":""},m.createElement(A,{to:"/3d-global"},"Constrained global rotation"))))}B.render(m.createElement(m.StrictMode,null,m.createElement(De,null)),document.getElementById("root"));
