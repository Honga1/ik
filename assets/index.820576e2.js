var e=Object.defineProperty,t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,o=(t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,a=(e,a)=>{for(var i in a||(a={}))n.call(a,i)&&o(e,i,a[i]);if(t)for(var i of t(a))r.call(a,i)&&o(e,i,a[i]);return e};import{r as i,u as l,V as c,B as s,L as u,C as m,a as f,R as h,b as p,H as d,c as E,d as g,e as v}from"./vendor.992d091c.js";function b(e,t,n,r){var o,a,i,l=null!==(o=null==r?void 0:r.deltaAngle)&&void 0!==o?o:1e-5,c=null!==(a=null==r?void 0:r.learningRate)&&void 0!==a?a:1e-4,s=null!==(i=null==r?void 0:r.acceptedError)&&void 0!==i?i:0,u=x(e,{position:t,rotation:0}),m=u.transforms,f=u.effectorPosition,h=P(n,f);if(!(h<s)){if(m.length!==e.length+1)throw new Error("Joint transforms should have the same length as links + 1. Got "+m.length+", expected "+e.length);e.map((function(t,r){var o,a,i=w(function(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e}([{length:t.length,rotation:t.rotation+l}],e.slice(r+1)),m[r],n);return{bone:t,angleStep:-((i-h)/l)*(o=c,(a=i)>100?o:o*((a+25)/125))}})).forEach((function(e){var t=e.bone,n=e.angleStep;if(t.rotation+=n,void 0!==t.constraint){var r,o,a,i=t.constraint/2;t.rotation=(r=t.rotation,o=-i,a=i,Math.min(Math.max(o,r),a))}}))}}function w(e,t,n){var r=function(e,t){return x(e,t).effectorPosition}(e,t);return P(n,r)}function x(e,t){for(var n=[t],r=0;r<e.length;r++){var o=e[r],a=n[r],i=o.rotation+a.rotation,l=R(o.length,i),c=M(l,a.position);n.push({position:c,rotation:i})}return{transforms:n,effectorPosition:n[n.length-1].position}}var y=function(e,t,n){for(var r=new Array(2),o=0;o<2;o++){var a=e[o],i=t[o];r[o]=n(a,i)}return B(r)},M=function(e,t){return y(e,t,(function(e,t){return e+t}))},k=function(e){return Math.pow(function(e){return Math.pow(e[0],2)+Math.pow(e[1],2)}(e),.5)},P=function(e,t){var n=y(e,t,(function(e,t){return e-t}));return k(n)},B=function(e){if(2!==e.length)throw new Error("Cannot create V2 from "+e+", length is "+e.length+". Length should be 2");return e},R=function(e,t){return r=t,o=(n=[e,0])[0],a=n[1],i=Math.cos(r),l=Math.sin(r),[o*i-a*l,o*l+a*i];var n,r,o,a,i,l};const D=({link:e,child:t})=>{const n=i.exports.useRef(),r=i.exports.useRef();l((()=>{n.current&&r.current&&(n.current.rotation.set(0,0,e.rotation),r.current.position.set(e.length,0,0))}));const o=i.exports.useMemo((()=>{const t=[new c,new c(e.length,0,0)],n=(new s).setFromPoints(t),r=new u({color:new m("#8B008B")});return new f(n,r)}),[e.length]);return h.createElement("group",{ref:n},h.createElement("mesh",{ref:r},h.createElement("sphereBufferGeometry",{args:[20,100,100]}),h.createElement("meshNormalMaterial",null),t&&h.createElement(D,a({},t))),h.createElement("primitive",{object:o}))},j=({position:e,sequence:t,target:n})=>{const r=i.exports.useRef(),o=i.exports.useMemo((()=>function(e){let t;for(let n=e.length-1;n>=0;n--){const r={link:e[n]};void 0!==t?t={link:r.link,child:t}:t=r}return t}(t)),[t]);return l((()=>{r.current&&(r.current.position.set(...e,0),b(t,e,n))})),h.createElement("mesh",{ref:r},h.createElement("boxBufferGeometry",{args:[50,50]}),h.createElement("meshNormalMaterial",null),o&&h.createElement(D,a({},o)))};const A=({links:e,basePosition:t})=>{const n=i.exports.useRef();return l((()=>{var r;if(void 0===n.current)return;const{transforms:o}=x(e,{position:t,rotation:0});for(let e=0;e<n.current.children.length;e++){const t=n.current.children[e],a=null==(r=o[e])?void 0:r.position;if(void 0===a)throw new Error(`No corresponding child position for index ${e}`);t.position.set(...a,100)}})),h.createElement("group",{ref:n},Array.from({length:e.length+1}).map(((e,t)=>h.createElement("mesh",{key:t},h.createElement("boxBufferGeometry",{args:[12.5,12.5]}),h.createElement("meshBasicMaterial",{color:"red"})))))},I=({target:e,links:t,basePosition:n})=>{const r=i.exports.useRef(null);return((e,t)=>{const n=i.exports.useRef(),r=i.exports.useRef(),o=i.exports.useCallback((async a=>{void 0===r.current&&(r.current=a);const i=a-r.current;i>1e3/e&&(await t(i),r.current=a),n.current=requestAnimationFrame(o)}),[t,e]);i.exports.useEffect((()=>(n.current=requestAnimationFrame(o),()=>{n.current&&cancelAnimationFrame(n.current)})),[o])})(1,(()=>{r.current&&(r.current.innerText=w(t,{position:n,rotation:0},e).toFixed(3))})),h.createElement("div",{style:{position:"absolute",top:0,left:0,userSelect:"none"}},h.createElement("table",null,h.createElement("tbody",null,h.createElement("tr",null,h.createElement("td",null,"Distance"),h.createElement("td",{ref:r})))))},O=({position:e})=>h.createElement("mesh",{scale:[50,50,1],position:[...e,-1]},h.createElement("boxBufferGeometry",null),h.createElement("meshBasicMaterial",{color:"hotpink"})),S=[{rotation:0,length:50},{rotation:0,constraint:Math.PI,length:200},{rotation:0,constraint:Math.PI,length:200},{rotation:0,constraint:Math.PI,length:200}],q=[0,0];function C(){const[e,t]=i.exports.useState([500,50]);return h.createElement("div",{onClick:e=>{const n=[e.clientX-window.innerWidth/2,-e.clientY+window.innerHeight/2];t(n)}},h.createElement(p,{style:{width:"100%",height:"100%",position:"absolute",backgroundColor:"aquamarine"},orthographic:!0,linear:!0,camera:{near:-1e3}},h.createElement(j,{position:q,sequence:S,target:e}),h.createElement(A,{links:S,basePosition:q}),h.createElement(O,{position:e})),h.createElement(I,{target:e,links:S,basePosition:q}))}function F(){return h.createElement(d,{basename:"/"},h.createElement(G,null),h.createElement(E,{path:"/2d"},h.createElement(C,null)),h.createElement(E,{path:"/3d"},"Three D Demo yet to be implemented"))}function G(){return h.createElement("div",{style:{position:"absolute",zIndex:10}},h.createElement("ul",null,h.createElement("li",null,h.createElement(g,{to:"/2d"},"2D Demo")),h.createElement("li",null,h.createElement(g,{to:"/3d"},"3D Demo"))))}v.render(h.createElement(h.StrictMode,null,h.createElement(F,null)),document.getElementById("root"));
